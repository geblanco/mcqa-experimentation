schema: '2.0'
stages:
  format-quail-to-race@train:
    cmd: src/etl/preprocess_quail_to_race.py data/quail/train.json data/quail/train_answers.json
      -o data/quail_race_fmt_original/train.json
    deps:
    - path: data/quail/train.json
      md5: 5409940d9b8479dc51fe56c9b5607344
      size: 4498702
    - path: data/quail/train_answers.json
      md5: c1b17d1e9bb8bbce4b28c253e5167001
      size: 199358
    - path: src/etl/preprocess_quail_to_race.py
      md5: 2009306154dd6e92058826b7032328bb
      size: 3355
    outs:
    - path: data/quail_race_fmt_original/train.json
      md5: 6c67d6a9e3c054cf471ef467fbf23e26
      size: 2863957
  format-quail-to-race@dev:
    cmd: src/etl/preprocess_quail_to_race.py data/quail/dev.json data/quail/dev_answers.json
      -o data/quail_race_fmt_original/dev.json
    deps:
    - path: data/quail/dev.json
      md5: 710c954716143d6d3c8c2ef2044f5c0c
      size: 955449
    - path: data/quail/dev_answers.json
      md5: 1665e633ee7aa0183a45a3749e4e061b
      size: 46710
    - path: src/etl/preprocess_quail_to_race.py
      md5: 2009306154dd6e92058826b7032328bb
      size: 3355
    outs:
    - path: data/quail_race_fmt_original/dev.json
      md5: b2573225520d6ae103b7b1f899ebd433
      size: 611156
  format-quail-no-empty-answers@dev:
    cmd: python src/etl/choices/reformat_dataset.py -d data/quail_race_fmt -o data/quail_no_empty_answers
      -s dev --no_answer_text "not enough information" --task generic
    deps:
    - path: data/quail_race_fmt
      md5: b10a55ed7679e1157226da34aa0e1602.dir
      size: 172019959
      nfiles: 10
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/quail_no_empty_answers/dev.json
      md5: 03fdd9ecc0a41dfd75062e71c53fae43
      size: 1438151
  format-quail-no-empty-answers-removed@dev:
    cmd: python src/etl/choices/reformat_dataset.py -d data/quail_race_fmt -o data/quail_empty_answers_removed
      -s dev --no_answer_text "not enough information"
    deps:
    - path: data/quail_race_fmt
      md5: 96f33684356371185c1fb8ee7b5c490b.dir
      size: 3475135
      nfiles: 3
    - path: src/etl/choices/reformat_dataset.py
      md5: e8e3c8d3f5afcfc5c8c9fda62296ac7d
      size: 4721
    outs:
    - path: data/quail_empty_answers_removed/dev.json
      md5: e8c4ed4ea82859767ebbdd4bcec51d3f
      size: 524048
  format-quail-no-empty-answers-removed@train:
    cmd: python src/etl/choices/reformat_dataset.py -d data/quail_race_fmt -o data/quail_empty_answers_removed
      -s train --no_answer_text "not enough information"
    deps:
    - path: data/quail_race_fmt
      md5: 96f33684356371185c1fb8ee7b5c490b.dir
      size: 3475135
      nfiles: 3
    - path: src/etl/choices/reformat_dataset.py
      md5: e8e3c8d3f5afcfc5c8c9fda62296ac7d
      size: 4721
    outs:
    - path: data/quail_empty_answers_removed/train.json
      md5: d3a6f28fa96f7431cee0ec4aa4193105
      size: 2451755
  format-quail-no-empty-answers@train:
    cmd: python src/etl/choices/reformat_dataset.py -d data/quail_race_fmt -o data/quail_no_empty_answers
      -s train --no_answer_text "not enough information" --task generic
    deps:
    - path: data/quail_race_fmt
      md5: b10a55ed7679e1157226da34aa0e1602.dir
      size: 172019959
      nfiles: 10
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/quail_no_empty_answers/train.json
      md5: 20ac60fcc4f0d60230ca4d47e88259df
      size: 2115891
  format-race@dev:
    cmd: python src/etl/choices/reformat_dataset.py -d data/RACE/ -o data/race_formatted
      -s dev --no_answer_text "not enough information" --task race --mask --proportion
      0.0
    deps:
    - path: data/RACE/dev
      md5: 1be4be7086bef61408432e677c5056d0.dir
      size: 3308878
      nfiles: 1389
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/race_formatted/dev.json
      md5: 6591fdc9f97af35644362837f6f58176
      size: 3318636
  format-race@train:
    cmd: python src/etl/choices/reformat_dataset.py -d data/RACE/ -o data/race_formatted
      -s train --no_answer_text "not enough information" --task race --mask --proportion
      0.0
    deps:
    - path: data/RACE/train
      md5: 22be488af9b6b86c28e4f0423670272f.dir
      size: 60493414
      nfiles: 25137
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/race_formatted/train.json
      md5: 7e56668cd17b8db851e04d4d8bbe8ce8
      size: 60716205
  format-race-with-empty-answers@train:
    cmd: python src/etl/choices/reformat_dataset.py -d data/race -o data/race_with_empty_answers
      -s train --no_answer_text "not enough information" --task generic --mask --mask_correct
      --proportion 0.11
    deps:
    - path: data/race/train.json
      md5: 8397cf0a5681f3ce9de660ec391f196b
      size: 55225702
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/race_with_empty_answers/train.json
      md5: be1fe072e903c4dba5418ad9f426135d
      size: 55141446
  format-race-with-empty-answers@dev:
    cmd: python src/etl/choices/reformat_dataset.py -d data/race -o data/race_with_empty_answers
      -s dev --no_answer_text "not enough information" --task generic --mask --mask_correct
      --proportion 0.11
    deps:
    - path: data/race/dev.json
      md5: 8e09eb06e00fe8e14b125a20ee1cd5ee
      size: 30512703
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/race_with_empty_answers/dev.json
      md5: be0e27bbf4071bd03bc2d3bc5915c5eb
      size: 30485781
  split-race:
    cmd: src/etl/split_dataset.py --data_path data/race_formatted --overwrite --output_dir
      data/race --outputs train.json dev.json --move dev.json test.json --proportion
      0.75 --split train --task generic
    deps:
    - path: data/race_formatted/dev.json
      md5: 6591fdc9f97af35644362837f6f58176
      size: 3318636
    - path: data/race_formatted/train.json
      md5: 7e56668cd17b8db851e04d4d8bbe8ce8
      size: 60716205
    outs:
    - path: data/race/dev.json
      md5: 8e09eb06e00fe8e14b125a20ee1cd5ee
      size: 30512703
    - path: data/race/test.json
      md5: 6591fdc9f97af35644362837f6f58176
      size: 3318636
    - path: data/race/train.json
      md5: 8397cf0a5681f3ce9de660ec391f196b
      size: 55225702
  split-quail:
    cmd: src/etl/split_dataset.py --data_path data/quail_race_fmt_original --overwrite
      --output_dir data/quail_race_fmt --outputs train.json dev.json --move dev.json
      test.json --no_answer_text "not enough information" --proportion 0.75 --split
      train --task generic
    deps:
    - path: data/quail_race_fmt_original/dev.json
      md5: b2573225520d6ae103b7b1f899ebd433
      size: 611156
    - path: data/quail_race_fmt_original/train.json
      md5: 6c67d6a9e3c054cf471ef467fbf23e26
      size: 2863957
    outs:
    - path: data/quail_race_fmt/dev.json
      md5: b0ad6f729159b745450951cf45da936e
      size: 1546432
    - path: data/quail_race_fmt/test.json
      md5: b2573225520d6ae103b7b1f899ebd433
      size: 611156
    - path: data/quail_race_fmt/train.json
      md5: fd57d3acc9daaad34f0823b093d9cae5
      size: 2426101
  format-quail-no-empty-answers@test:
    cmd: python src/etl/choices/reformat_dataset.py -d data/quail_race_fmt -o data/quail_no_empty_answers
      -s test --no_answer_text "not enough information" --task generic
    deps:
    - path: data/quail_race_fmt
      md5: b10a55ed7679e1157226da34aa0e1602.dir
      size: 172019959
      nfiles: 10
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/quail_no_empty_answers/test.json
      md5: e8c4ed4ea82859767ebbdd4bcec51d3f
      size: 524048
  format-race-with-empty-answers@test:
    cmd: python src/etl/choices/reformat_dataset.py -d data/race -o data/race_with_empty_answers
      -s test --no_answer_text "not enough information" --task generic --mask --mask_correct
      --proportion 0.11
    deps:
    - path: data/race/test.json
      md5: 6591fdc9f97af35644362837f6f58176
      size: 3318636
    - path: src/etl/choices/reformat_dataset.py
      md5: 7829c688d5a7050c7bbe76e4b13206b6
      size: 7044
    outs:
    - path: data/race_with_empty_answers/test.json
      md5: f8b6d2ed1a7347708e7c63c567c31405
      size: 3311417
