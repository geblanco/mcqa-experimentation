schema: '2.0'
stages:
  bert-train@race-with-empty-answers:
    cmd: src/processing/run.sh params/model-params.yaml:race.train --data_dir "data/race_with_empty_answers"
      --model_name_or_path "data/models/bert-base-uncased" --output_dir "data/models/bert-train-race-with-empty-answers"
      --metrics_dir "data/metrics/bert-train-race-with-empty-answers" --results_dir
      "data/results/bert-train-race-with-empty-answers" --cache_dir "/tmp"
    deps:
    - path: data/models/bert-base-uncased
      md5: 05489734d130b7417f8e9f9bce0b12f8.dir
      size: 438245493
      nfiles: 5
    - path: data/race_with_empty_answers/dev.json
      md5: 23b7270f6eac768a145f2f6b21b9ddbf
      size: 3307280
    - path: data/race_with_empty_answers/train.json
      md5: 23d4742ea42fac09ebd535439eca9568
      size: 60502087
    - path: src/processing/run.sh
      md5: c13caa779e2050a5d0d9c1781a5fb217
      size: 1619
    params:
      params/model-params.yaml:
        race.train:
          do_train: true
          do_eval: true
          num_train_epochs: 2
          per_device_train_batch_size: 2
          model_type: bert
          task_name: generic
          fp16: true
          fp16_opt_level: O1
          max_seq_length: 484
          gradient_accumulation_steps: 8
          learning_rate: 5e-05
          warmup_steps: 500
          save_steps: 0
    outs:
    - path: data/models/bert-train-race-with-empty-answers/config.json
      md5: fda1d82a923cf7ffd8b9da484296692f
      size: 698
    - path: data/models/bert-train-race-with-empty-answers/pytorch_model.bin
      md5: 40dd0498d6d5468cd0927e65da201291
      size: 438016173
    - path: data/models/bert-train-race-with-empty-answers/special_tokens_map.json
      md5: 8b3fb1023167bb4ab9d70708eb05f6ec
      size: 112
    - path: data/models/bert-train-race-with-empty-answers/tokenizer_config.json
      md5: acaa1589c694bf6f6c146b3bac976f67
      size: 161
    - path: data/models/bert-train-race-with-empty-answers/training_args.bin
      md5: 928b74817e46103eaf10b48bb0dd4ecb
      size: 1839
    - path: data/models/bert-train-race-with-empty-answers/vocab.txt
      md5: 64800d5d8528ce344256daf115d4965e
      size: 231508
    - path: data/results/bert-train-race-with-empty-answers/eval_nbest_predictions.json
      md5: 0634e1ae668d844134362e6ea2b4ce1f
      size: 676066
    - path: data/results/bert-train-race-with-empty-answers/eval_predictions.json
      md5: 3984614dcbce2190c9582587c97b3b7f
      size: 146253
    - path: data/results/bert-train-race-with-empty-answers/train_nbest_predictions.json
      md5: 8ffd43db428c8d2f155f7d2ec1ac9218
      size: 12243937
    - path: data/results/bert-train-race-with-empty-answers/train_predictions.json
      md5: 6f78216e83e575aad9acef297bf52590
      size: 2805048
  bert-train@quail-no-empty-answers:
    cmd: src/processing/run.sh params/model-params.yaml:quail.train --data_dir "data/quail_no_empty_answers"
      --model_name_or_path "data/models/bert-base-uncased" --output_dir "data/models/bert-train-quail-no-empty-answers"
      --metrics_dir "data/metrics/bert-train-quail-no-empty-answers" --results_dir
      "data/results/bert-train-quail-no-empty-answers" --cache_dir "/tmp"
    deps:
    - path: data/models/bert-base-uncased
      md5: 35dba6921d591a96b63fd57423ca241d.dir
      size: 438245493
      nfiles: 5
    - path: data/quail_no_empty_answers/dev.json
      md5: 03fdd9ecc0a41dfd75062e71c53fae43
      size: 1438151
    - path: data/quail_no_empty_answers/train.json
      md5: 20ac60fcc4f0d60230ca4d47e88259df
      size: 2115891
    - path: src/processing/run.sh
      md5: c13caa779e2050a5d0d9c1781a5fb217
      size: 1619
    params:
      params/model-params.yaml:
        quail.train:
          do_train: true
          do_eval: true
          do_predict: true
          num_train_epochs: 2
          per_device_train_batch_size: 2
          model_type: bert
          task_name: generic
          fp16: true
          fp16_opt_level: O1
          max_seq_length: 484
          gradient_accumulation_steps: 8
          learning_rate: 5e-05
          warmup_steps: 500
          save_steps: 0
    outs:
    - path: data/models/bert-train-quail-no-empty-answers/config.json
      md5: fda1d82a923cf7ffd8b9da484296692f
      size: 698
    - path: data/models/bert-train-quail-no-empty-answers/pytorch_model.bin
      md5: 24a3bf65d749816b267b3a430f2d32da
      size: 438016173
    - path: data/models/bert-train-quail-no-empty-answers/special_tokens_map.json
      md5: 8b3fb1023167bb4ab9d70708eb05f6ec
      size: 112
    - path: data/models/bert-train-quail-no-empty-answers/tokenizer_config.json
      md5: acaa1589c694bf6f6c146b3bac976f67
      size: 161
    - path: data/models/bert-train-quail-no-empty-answers/training_args.bin
      md5: a11c0bd2a28ed10657056fe7d50b1150
      size: 1839
    - path: data/models/bert-train-quail-no-empty-answers/vocab.txt
      md5: 64800d5d8528ce344256daf115d4965e
      size: 231508
    - path: data/results/bert-train-quail-no-empty-answers/eval_nbest_predictions.json
      md5: 65db9540dc5cb5e334281ad12f73a1a1
      size: 250563
    - path: data/results/bert-train-quail-no-empty-answers/eval_predictions.json
      md5: 897eb540affa26b1d419597c9f00d395
      size: 36385
    - path: data/results/bert-train-quail-no-empty-answers/test_nbest_predictions.json
      md5: 18eda193f1006416ba846936d1e51369
      size: 208412
    - path: data/results/bert-train-quail-no-empty-answers/test_predictions.json
      md5: 7b1e4e1a88437826dac45d0d6d02ed82
      size: 30785
    - path: data/results/bert-train-quail-no-empty-answers/train_nbest_predictions.json
      md5: b26bb82641fd0f5e502087b06572267b
      size: 741786
    - path: data/results/bert-train-quail-no-empty-answers/train_predictions.json
      md5: 55376c2b39785fbdf9da449486a07b78
      size: 109137
  bert-train@quail:
    cmd: src/processing/run.sh params/model-params.yaml:quail.train --data_dir "data/quail_race_fmt"
      --model_name_or_path "data/models/bert-base-uncased" --output_dir "data/models/bert-train-quail"
      --metrics_dir "data/metrics/bert-train-quail" --results_dir "data/results/bert-train-quail"
      --cache_dir "/tmp"
    deps:
    - path: data/models/bert-base-uncased
      md5: 35dba6921d591a96b63fd57423ca241d.dir
      size: 438245493
      nfiles: 5
    - path: data/quail_race_fmt/dev.json
      md5: b0ad6f729159b745450951cf45da936e
      size: 1546432
    - path: data/quail_race_fmt/train.json
      md5: fd57d3acc9daaad34f0823b093d9cae5
      size: 2426101
    - path: src/processing/run.sh
      md5: c13caa779e2050a5d0d9c1781a5fb217
      size: 1619
    params:
      params/model-params.yaml:
        quail.train:
          do_train: true
          do_eval: true
          do_predict: true
          num_train_epochs: 2
          per_device_train_batch_size: 2
          model_type: bert
          task_name: generic
          fp16: true
          fp16_opt_level: O1
          max_seq_length: 484
          gradient_accumulation_steps: 8
          learning_rate: 5e-05
          warmup_steps: 500
          save_steps: 0
    outs:
    - path: data/models/bert-train-quail/config.json
      md5: fda1d82a923cf7ffd8b9da484296692f
      size: 698
    - path: data/models/bert-train-quail/pytorch_model.bin
      md5: a5a8599f86b660bb57cd8f128a66c06b
      size: 438016173
    - path: data/models/bert-train-quail/special_tokens_map.json
      md5: 8b3fb1023167bb4ab9d70708eb05f6ec
      size: 112
    - path: data/models/bert-train-quail/tokenizer_config.json
      md5: acaa1589c694bf6f6c146b3bac976f67
      size: 161
    - path: data/models/bert-train-quail/training_args.bin
      md5: 65076fae2f05c88b0fd48734135e24a0
      size: 1775
    - path: data/models/bert-train-quail/vocab.txt
      md5: 64800d5d8528ce344256daf115d4965e
      size: 231508
    - path: data/results/bert-train-quail/eval_nbest_predictions.json
      md5: e070f804500b90b428ccf65ded43b0a9
      size: 336637
    - path: data/results/bert-train-quail/eval_predictions.json
      md5: aa36f942917720966cff112c55bc4c37
      size: 40993
    - path: data/results/bert-train-quail/test_nbest_predictions.json
      md5: 4bebec172b641197708d332680db2a39
      size: 280762
    - path: data/results/bert-train-quail/test_predictions.json
      md5: e18a9fff699f9d5f47c6099f9613c927
      size: 34625
    - path: data/results/bert-train-quail/train_nbest_predictions.json
      md5: 417f8b9633b899bea9eb953f286ab7be
      size: 999366
    - path: data/results/bert-train-quail/train_predictions.json
      md5: 8cc38f0f4179dbb1e660d5d1e214b3c0
      size: 122945
  bert-train@race:
    cmd: src/processing/run.sh params/model-params.yaml:race.train --data_dir "data/race"
      --model_name_or_path "data/models/bert-base-uncased" --output_dir "data/models/bert-train-race"
      --metrics_dir "data/metrics/bert-train-race" --results_dir "data/results/bert-train-race"
      --cache_dir "/tmp"
    deps:
    - path: data/models/bert-base-uncased
      md5: 05489734d130b7417f8e9f9bce0b12f8.dir
      size: 438245493
      nfiles: 5
    - path: data/race/dev.json
      md5: a6cb814049142b0474f33480183e38f9
      size: 3318624
    - path: data/race/train.json
      md5: 4c5619df49657bd834135bf9e5124e0e
      size: 60716209
    - path: src/processing/run.sh
      md5: c13caa779e2050a5d0d9c1781a5fb217
      size: 1619
    params:
      params/model-params.yaml:
        race.train:
          do_train: true
          do_eval: true
          num_train_epochs: 2
          per_device_train_batch_size: 2
          model_type: bert
          task_name: generic
          fp16: true
          fp16_opt_level: O1
          max_seq_length: 484
          gradient_accumulation_steps: 8
          learning_rate: 5e-05
          warmup_steps: 500
          save_steps: 0
    outs:
    - path: data/models/bert-train-race/config.json
      md5: fda1d82a923cf7ffd8b9da484296692f
      size: 698
    - path: data/models/bert-train-race/pytorch_model.bin
      md5: db05c017333950e2a96682f89b89932d
      size: 438016173
    - path: data/models/bert-train-race/special_tokens_map.json
      md5: 8b3fb1023167bb4ab9d70708eb05f6ec
      size: 112
    - path: data/models/bert-train-race/tokenizer_config.json
      md5: acaa1589c694bf6f6c146b3bac976f67
      size: 161
    - path: data/models/bert-train-race/training_args.bin
      md5: 922128a4831645b0655fa6a2cb3bbb77
      size: 1775
    - path: data/models/bert-train-race/vocab.txt
      md5: 64800d5d8528ce344256daf115d4965e
      size: 231508
    - path: data/results/bert-train-race/eval_nbest_predictions.json
      md5: 3bfa8205c07a44837e479d18c1fbb660
      size: 671365
    - path: data/results/bert-train-race/eval_predictions.json
      md5: 35eceb7c25ebc909a7f1aa8803c50d88
      size: 146253
    - path: data/results/bert-train-race/train_nbest_predictions.json
      md5: 5b055a6850c3d0401cb1b28ef98505e8
      size: 12170122
    - path: data/results/bert-train-race/train_predictions.json
      md5: 158739b34fbbfd861d427a5feddf613c
      size: 2805048
